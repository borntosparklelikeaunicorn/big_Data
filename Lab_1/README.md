# Лабораторная работа №1
## Introduction to Apache Spark

В ходе лабораторной работы был выполнен ряд заданий по исследованию данных о поездках на велосипедах и станциях, ниже представлены скриншоты результатов и краткое описание хода выполнения заданий

**1. Найти велосипед с максимальным временем пробега.** 

Здесь происходит группировка данных по 'bike_id' и вычисление максимальной длительности поездки для каждого велосипеда, затем происходит сортировка результатов по убыванию длительности и вывод первой строки, что и будет являться ответом

<img width="313" alt="Снимок экрана 2024-04-21 в 23 06 33" src="https://github.com/borntosparklelikeaunicorn/big_Data/assets/147177755/63d59ea2-c857-40e4-8684-58b95990ab89">

**2. Найти наибольшее геодезическое расстояние между станциями.**  

Выбираются столбцы 'id', 'lat' и 'long' из DataFrame stations и сохранение в переменной stations_data, 
создаются комбинации станций и выбор только различных комбинаций, затем вычисляется евклидово расстояние между двумя точками, после чего находится максимальное  

<img width="611" alt="Снимок экрана 2024-04-21 в 23 07 05" src="https://github.com/borntosparklelikeaunicorn/big_Data/assets/147177755/a10190fe-bd37-4b33-b6cc-2aed31737916">

**3. Найти путь велосипеда с максимальным временем пробега через станции.**

Выбираются столбцы 'id', 'bike_id', 'start_station_id' и 'end_station_id' из DataFrame df_trips, 
затем происходит фильтрация по 'bike_id' равному 535 и сортировка по 'id', далее вывод отфильтрованных по условиям данных и количества строк

<img width="552" alt="Снимок экрана 2024-04-21 в 23 27 10" src="https://github.com/borntosparklelikeaunicorn/big_Data/assets/147177755/dc64c205-d445-48f4-ab9e-4e2fb16faace">

**4. Найти количество велосипедов в системе.**

<img width="183" alt="Снимок экрана 2024-04-21 в 23 27 52" src="https://github.com/borntosparklelikeaunicorn/big_Data/assets/147177755/0434bc8f-0342-43ed-9221-5bdd57822f70">

**5. Найти пользователей потративших на поездки более 3 часов.**

Фильтруем данные, оставляя только те записи, где продолжительность поездки больше или равна 10800 секунд (3 часа)

<img width="373" alt="Снимок экрана 2024-04-21 в 23 28 58" src="https://github.com/borntosparklelikeaunicorn/big_Data/assets/147177755/15a8eb0f-df1b-4465-aa03-bb868769f72b">
